# {{ ansible_managed }}
# Filebeat configuration for Wazuh

filebeat.modules:
  - module: wazuh
    alerts:
      enabled: true
    archives:
      enabled: false

setup.template.json.enabled: true
setup.template.json.path: "/etc/filebeat/wazuh-template.json"
setup.template.json.name: "wazuh"
setup.template.overwrite: true
setup.ilm.enabled: false

output.elasticsearch:
  hosts: ["https://{{ wazuh_indexer_ip }}:{{ wazuh_indexer_port }}"]
  protocol: https
  username: "admin"
  password: "{{ wazuh_indexer_admin_password }}"
  ssl.certificate_authorities:
    - /etc/filebeat/certs/root-ca.pem
  ssl.certificate: "/etc/filebeat/certs/{{ wazuh_indexer_node_name }}.pem"
  ssl.key: "/etc/filebeat/certs/{{ wazuh_indexer_node_name }}-key.pem"

logging.level: info
logging.to_files: true
logging.files:
  path: /var/log/filebeat
  name: filebeat
  keepfiles: 7
  permissions: 0644
